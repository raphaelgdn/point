#!/usr/bin/env groovy
pipeline {
    agent any
    stages {
        stage('Clean and prep workspace'){
            agent {
                label 'POWER'
            }   
            steps {
                sh 'rm -r *'
                git 'https://github.com/raphaelgdn/point'
                sh 'git clone https://github.com/raphaelgdn/point'
            }
        }   
        stage('Start VM WORK') {
            agent {
                label 'POWER'
            } 
            steps {
                sh 'sh ./start_machine.sh'
            }
        }        
        stage ('verify the VM is running') {
            agent {
                label 'POWER'
            }
            steps {
                ping '192.168.0.112'
            }
        }
        stage('Update time clock') {
            agent {
                label 'WORK'
            }
            steps {
                cmd 'W32tm /resync /force'
            }
        }
    }
}